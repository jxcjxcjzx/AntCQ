// one url 
// one parser 


// url :
// http://fanyi.baidu.com/#zh/en/%E6%89%93%E5%BC%80%E7%99%BE%E5%BA%A6%E7%BD%91%E9%A1%B5
/*

Request URL:http://fanyi.baidu.com/v2transapi
Request Method:POST
Status Code:200 OK
Request Headersview source
Accept-Encoding:gzip,deflate,sdch
Accept-Language:zh-CN,zh;q=0.8
Connection:keep-alive
Content-Length:86
Content-Type:application/x-www-form-urlencoded; charset=UTF-8
Cookie:BAIDUID=1EAE811600A0E473D26C7C5619A7F424:FG=1; BIDUPSID=1EAE811600A0E473D26C7C5619A7F424; PSTM=1432656600; H_PS_PSSID=16483_16420_1460_13350_12658_12825_10812_12867_16167_16284_16322_16211_16326_16424_16279_16459_16514_15125_12262_13932; BDUSS=pRWWhuUnU5UDJTVUNZdzhlLUpPRy0xYnNZQm9UWFVYbkhTUFBLbUZCS0c5TlZWQUFBQUFBJCQAAAAAAAAAAAEAAABUuS8Tz8LU2DLGtbXAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIZnrlWGZ65VSU; locale=zh; Hm_lvt_64ecd82404c51e03dc91cb9e8c025574=1437493584; Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574=1437493584
Host:fanyi.baidu.com
Origin:http://fanyi.baidu.com
Referer:http://fanyi.baidu.com/
User-Agent:Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36
X-Requested-With:XMLHttpRequest
Form Dataview sourceview URL encoded
from:zh
to:en
query:ÄãÊÇË­
transtype:realtime
simple_means_flag:3
Response Headersview source
Connection:keep-alive
Content-Type:application/json
Date:Tue, 21 Jul 2015 15:44:02 GMT
Server:Apache
tracecode:26419826610801053194072123
Transfer-Encoding:chunked

*/

/*
{"trans_result":{"from":"zh","to":"en","domain":"all","type":2,"status":0,"data":[{"dst":"Who are you","src":"\u4f60\u662f\u8c01","relation":[],"result":[[0,"Who are you",["0|9"],[],["0|9"],["0|11"]]]}]},"dict_result":{"edict":"","err_words":[],"zdict":"","simple_means":{"symbols":[{"word_symbol":"","parts":[{"part_name":"","means":[{"mean_id":"2463841","has_mean":"0","word_mean":"Who are you?","part_id":"2146817","split":"0"}]}],"symbol_mp3":"\n\n\n","symbol_id":"2143383","word_id":"2142263"}],"err_words":[],"word_name":"\u4f60\u662f\u8c01","word_id":"2142263"},"synthesize_means":false,"lang":"0","baike_means":{"content":"\u300a\u4f60\u662f\u8c01\u300b\u662f\u7533\u8d24\u660c\u6267\u5bfc\u768417\u96c6\u7231\u60c5\u7c7b\u7535\u89c6\u5267\u3002\u7531\u5c39\u7ee7\u5c1a\u3001\u9ad8\u96c5\u62c9\u3001\u59dc\u5357\u5409\u7b49\u9886\u8854\u4e3b\u6f14\u3002\u300a\u4f60\u662f\u8c01\u300b\u8bb2\u8ff0\u4e86\u4e00\u4e2a\u6b7b\u53bb\u7684\u7236\u4eb2\u4e3a\u4e86\u89c1\u5973\u513f\u6700\u540e\u4e00\u9762\uff0c\u501f\u4f53\u8fd8\u9b42\u9644\u5230\u4e00\u4e2a\u5e74\u8f7b\u4eba\u8eab\u4e0a\u7684\u611f\u4eba\u6545\u4e8b\u3002\u8be5\u52672008\u5e743\u67085\u65e5\u5728\u97e9\u56fdMBC\u7535\u89c6\u53f0\u9996\u64ad\u3002","link":"http:\/\/baike.baidu.com\/subview\/4663\/9269558.htm","image":"http:\/\/c.hiphotos.baidu.com\/baike\/w%3D500\/sign=1c1a851c0b2442a7ae0efda5e142ad95\/377adab44aed2e73099f39b38301a18b87d6fa3f.jpg","image_url":"http:\/\/baike.baidu.com\/pic\/\/57479\/0\/377adab44aed2e73099f39b38301a18b87d6fa3f"}},"liju_result":{"double":"[[[[\"\u6211\",\"w_0\",\"w_0,w_6\",0],[\"\u77e5\u9053\",\"w_1\",\"w_1,w_7\",0],[\"\u4f60\",\"w_2\",\"w_2,w_9\",1],[\"\u662f\",\"w_3\",\"w_3,w_10\",1],[\"\u8c01\",\"w_4\",\"w_4,w_8\",1],[\"\u3002\",\"w_5\",\"w_5,w_11\",0]],[[\"I\",\"w_6\",\"w_0,w_6\",0,\" \"],[\"know\",\"w_7\",\"w_1,w_7\",0,\" \"],[\"who\",\"w_8\",\"w_4,w_8\",1,\" \"],[\"you\",\"w_9\",\"w_2,w_9\",1,\" \"],[\"are\",\"w_10\",\"w_3,w_10\",1],[\".\",\"w_11\",\"w_5,w_11\",0]],\"http:\/\/www.shooter.cn\",430],[[[\"\u6211\",\"w_24\",\"w_24,w_30\",0],[\"\u77e5\u9053\",\"w_25\",\"w_25,w_31\",0],[\"\u4f60\",\"w_26\",\"w_26,w_33\",1],[\"\u662f\",\"w_27\",\"w_27,w_34\",1],[\"\u8c01\",\"w_28\",\"w_28,w_32\",1],[\"\uff01\",\"w_29\",\"w_29,w_35\",0]],[[\"I\",\"w_30\",\"w_24,w_30\",0,\" \"],[\"know\",\"w_31\",\"w_25,w_31\",0,\" \"],[\"who\",\"w_32\",\"w_28,w_32\",1,\" \"],[\"you\",\"w_33\",\"w_26,w_33\",1,\" \"],[\"are\",\"w_34\",\"w_27,w_34\",1],[\"!\",\"w_35\",\"w_29,w_35\",0]],\"http:\/\/www.shooter.cn\",1133],[[[\"\u544a\u8bc9\",\"w_48\",\"w_48,w_54\",0],[\"\u6211\",\"w_49\",\"w_49,w_55\",0],[\"\u4f60\",\"w_50\",\"w_50,w_57\",1],[\"\u662f\",\"w_51\",\"w_51,w_58\",1],[\"\u8c01\",\"w_52\",\"w_52,w_56\",1],[\"\uff01\",\"w_53\",\"w_53,w_59\",0]],[[\"Tell\",\"w_54\",\"w_48,w_54\",0,\" \"],[\"me\",\"w_55\",\"w_49,w_55\",0,\" \"],[\"who\",\"w_56\",\"w_52,w_56\",1,\" \"],[\"you\",\"w_57\",\"w_50,w_57\",1,\" \"],[\"are\",\"w_58\",\"w_51,w_58\",1],[\"!\",\"w_59\",\"w_53,w_59\",0]],\"http:\/\/www.shooter.cn\",1501],[[[\"\u90a3\u4e48\",\"w_72\",\"w_72,w_78\",0],[\"\u4f60\",\"w_73\",\"w_73,w_81\",1],[\"\u662f\",\"w_74\",\"w_74,w_80\",1],[\"\u8c01\",\"w_75\",\"w_75,w_79\",1],[\"\u5462\",\"w_76\",\"\",0],[\"\uff1f\",\"w_77\",\"w_77,w_82\",0]],[[\"And\",\"w_78\",\"w_72,w_78\",0,\" \"],[\"who\",\"w_79\",\"w_75,w_79\",1,\" \"],[\"are\",\"w_80\",\"w_74,w_80\",1,\" \"],[\"you\",\"w_81\",\"w_73,w_81\",1],[\"?\",\"w_82\",\"w_77,w_82\",0]],\"http:\/\/www.shooter.cn\",33176],[[[\"\u4f60\",\"w_94\",\"w_94,w_103\",1],[\"\u662f\",\"w_95\",\"w_95,w_102\",1],[\"\u8c01\",\"w_96\",\"w_96,w_100\",1],[\"\u7684\",\"w_97\",\"\",0],[\"\u59d0\u59d0\",\"w_98\",\"w_98,w_101\",0],[\"?\",\"w_99\",\"\",0]],[[\"Which\",\"w_100\",\"w_96,w_100\",1,\" \"],[\"sister\",\"w_101\",\"w_98,w_101\",0,\" \"],[\"are\",\"w_102\",\"w_95,w_102\",1,\" \"],[\"you\",\"w_103\",\"w_94,w_103\",1],[\"?\",\"w_104\",\"\",0]],\"http:\/\/www.shooter.cn\",108600]]","single":""}}

*/


//  the first ant we really press on 
// start of the shared part 
var _theSharedFunctionsAndStructures_shared_ = require("./common/theSharedFunctionsAndStructures.js");
var _reimplement_shared_ = require("./common/reimplement.js");
//  implement this later 
// var reimplementList = _reimplement_shared_.formList("enter",);
var reimplementList = ["enter","getBroadcastlist",];
var reimplementFunctionList = [enter,getBroadcastlist];
// should have this function , for each ant 
Array.prototype.contains = function(item){
	return RegExp(item).test(this);
};
function call(functionName,params){
	var functionIndex = -1;
	if(reimplementList.contains(functionName)){
		for(var i=0;i<reimplementList.length;i++){
			if(reimplementList[i] === functionName){
				functionIndex = i;
				break;
			}
		}
		if(functionIndex > -1){
			reimplementFunctionList[functionIndex](params);
		}
	}else{
		// no implementation , sorry
	}
}
var theSharedFunctionsAndStructures = {
	// as mentioned, this is shared among all the ants , must implement 
	//  from _theSharedFunctionsAndStructures_shared_	
	// make it more natural later 
	
	call : function(functionName, params){
		if(_theSharedFunctionsAndStructures_shared_.hasFunction(functionName)){
			if(!reimplementList.contains(functionName)){
				// call function in shared library 
				// console.log(" start to call function shared  functionName is : "+functionName+"  param is : "+params);
				_theSharedFunctionsAndStructures_shared_.call(functionName,params);
			}
			else{
				// there are some reimplements ,call them 	
				call(functionName,params);
			}
		}else{
			// this kind of function does not exist yet
		}
	}	
}
// end of the shared part 

/*
 the reimplement function list , remember 
 capsule them in corresponding list 
*/
 function enter(){
	// this function represents enter of function 
	// for debug only , use log system to replace this later 
	console.log(" entering translateAnt , welcome ...  ");
 }

 var preHandler = {
	prehandle : function(_action){
		// dp broadcast first 
		theSharedFunctionsAndStructures.call("broadcast",[_action,getBroadcastlist()]);
	}
 };
 
 var Handler = {
	handle : function(_action){
		
	}
	
 };
 
 var _broadcastList = ["videoAnt"];
 
 function getBroadcastlist(){
	return _broadcastList;
 }
 
 function getPrehandler(){
	return preHandler;
 }
 
 function getHandler(){
	return Handler;
 }
 
 /*  end of reimplement list  */


// the test function 




function tmp_test(){
	
}


module.exports = {
	
	// if this is an seed ant, just export the tmp_test function or 
	// several functions 
	tmp_test : tmp_test,
	
	enter : enter,
	
	getPrehandler : getPrehandler,
	
	getHandler : getHandler

}

